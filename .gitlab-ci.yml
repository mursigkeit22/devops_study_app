include:
  - template: Security/SAST.gitlab-ci.yml
  - local: 'yml_configs/.backend.yml'
  - local: 'yml_configs/.frontend.yml'
  - local: 'yml_configs/.notification.yml'
  - local: 'yml_configs/.sast.yml'
  #- local: 'yml_configs/.sonar.yml'
  
stages:
  - build
  - test
  - notify

sonarqube-backend-sast:
  stage: test
  rules:
    - changes:
      - backend/*
  image: maven:3.8-openjdk-16 
  script:
    - cd backend
    - >
       mvn verify sonar:sonar -Dsonar.qualitygate.wait=true
      -Dsonar.projectName="09_${GITLAB_USER_NAME}_BACKEND"
      -Dsonar.projectKey=${SONAR_PROJECT_KEY_BACKEND}
      -Dsonar.host.url=${SONARQUBE_URL}
      -Dsonar.login=${SONAR_LOGIN_BACKEND} 

	  
sonarqube-frontend-sast:
  stage: test
  rules:
    - changes:
      - frontend/*
  image: sonarsource/sonar-scanner-cli:latest
  script:
    - cd frontend
    - >
       sonar-scanner -Dsonar.qualitygate.wait=true
      -Dsonar.projectName="09_${GITLAB_USER_NAME}_FRONTEND"
      -Dsonar.projectKey=${SONAR_PROJECT_KEY_FRONTEND}
      -Dsonar.sources=.
      -Dsonar.host.url=${SONARQUBE_URL}
      -Dsonar.login=${SONAR_LOGIN_FRONTEND} 





    


